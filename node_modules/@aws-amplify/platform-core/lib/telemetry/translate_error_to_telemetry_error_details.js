"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.translateErrorToTelemetryErrorDetails = void 0;
const serializable_error_1 = require("./serializable_error");
/**
 * Translates an error into the shape of error details for telemetry
 */
const translateErrorToTelemetryErrorDetails = (error) => {
    if (!error) {
        return undefined;
    }
    let currentError = error;
    let errorDetails;
    try {
        while (currentError) {
            const serializedError = new serializable_error_1.SerializableError(currentError);
            const errorDetail = {
                name: serializedError.name,
            };
            if (errorDetails) {
                // this reverses the nesting so lowest level error is the top level error in our telemetry
                errorDetail.caused = errorDetails;
            }
            errorDetails = errorDetail;
            // eslint-disable-next-line @typescript-eslint/no-explicit-any
            currentError = currentError.cause;
        }
    }
    catch {
        // Don't propogate errors related to not being able to translate to error data, return what was collected
        return errorDetails;
    }
    return errorDetails;
};
exports.translateErrorToTelemetryErrorDetails = translateErrorToTelemetryErrorDetails;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNsYXRlX2Vycm9yX3RvX3RlbGVtZXRyeV9lcnJvcl9kZXRhaWxzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3RlbGVtZXRyeS90cmFuc2xhdGVfZXJyb3JfdG9fdGVsZW1ldHJ5X2Vycm9yX2RldGFpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNkRBQXlEO0FBR3pEOztHQUVHO0FBQ0ksTUFBTSxxQ0FBcUMsR0FBRyxDQUNuRCxLQUFhLEVBQ2MsRUFBRTtJQUM3QixJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDWCxPQUFPLFNBQVMsQ0FBQztJQUNuQixDQUFDO0lBQ0QsSUFBSSxZQUFZLEdBQXNCLEtBQUssQ0FBQztJQUM1QyxJQUFJLFlBQXVDLENBQUM7SUFFNUMsSUFBSSxDQUFDO1FBQ0gsT0FBTyxZQUFZLEVBQUUsQ0FBQztZQUNwQixNQUFNLGVBQWUsR0FBRyxJQUFJLHNDQUFpQixDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQzVELE1BQU0sV0FBVyxHQUE4QjtnQkFDN0MsSUFBSSxFQUFFLGVBQWUsQ0FBQyxJQUFJO2FBQzNCLENBQUM7WUFFRixJQUFJLFlBQVksRUFBRSxDQUFDO2dCQUNqQiwwRkFBMEY7Z0JBQzFGLFdBQVcsQ0FBQyxNQUFNLEdBQUcsWUFBWSxDQUFDO1lBQ3BDLENBQUM7WUFFRCxZQUFZLEdBQUcsV0FBVyxDQUFDO1lBQzNCLDhEQUE4RDtZQUM5RCxZQUFZLEdBQUksWUFBb0IsQ0FBQyxLQUFLLENBQUM7UUFDN0MsQ0FBQztJQUNILENBQUM7SUFBQyxNQUFNLENBQUM7UUFDUCx5R0FBeUc7UUFDekcsT0FBTyxZQUFZLENBQUM7SUFDdEIsQ0FBQztJQUVELE9BQU8sWUFBWSxDQUFDO0FBQ3RCLENBQUMsQ0FBQztBQS9CVyxRQUFBLHFDQUFxQyx5Q0ErQmhEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2VyaWFsaXphYmxlRXJyb3IgfSBmcm9tICcuL3NlcmlhbGl6YWJsZV9lcnJvcic7XG5pbXBvcnQgeyBUZWxlbWV0cnlQYXlsb2FkIH0gZnJvbSAnLi90ZWxlbWV0cnlfcGF5bG9hZCc7XG5cbi8qKlxuICogVHJhbnNsYXRlcyBhbiBlcnJvciBpbnRvIHRoZSBzaGFwZSBvZiBlcnJvciBkZXRhaWxzIGZvciB0ZWxlbWV0cnlcbiAqL1xuZXhwb3J0IGNvbnN0IHRyYW5zbGF0ZUVycm9yVG9UZWxlbWV0cnlFcnJvckRldGFpbHMgPSAoXG4gIGVycm9yPzogRXJyb3IsXG4pOiBUZWxlbWV0cnlQYXlsb2FkWydlcnJvciddID0+IHtcbiAgaWYgKCFlcnJvcikge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgbGV0IGN1cnJlbnRFcnJvcjogRXJyb3IgfCB1bmRlZmluZWQgPSBlcnJvcjtcbiAgbGV0IGVycm9yRGV0YWlsczogVGVsZW1ldHJ5UGF5bG9hZFsnZXJyb3InXTtcblxuICB0cnkge1xuICAgIHdoaWxlIChjdXJyZW50RXJyb3IpIHtcbiAgICAgIGNvbnN0IHNlcmlhbGl6ZWRFcnJvciA9IG5ldyBTZXJpYWxpemFibGVFcnJvcihjdXJyZW50RXJyb3IpO1xuICAgICAgY29uc3QgZXJyb3JEZXRhaWw6IFRlbGVtZXRyeVBheWxvYWRbJ2Vycm9yJ10gPSB7XG4gICAgICAgIG5hbWU6IHNlcmlhbGl6ZWRFcnJvci5uYW1lLFxuICAgICAgfTtcblxuICAgICAgaWYgKGVycm9yRGV0YWlscykge1xuICAgICAgICAvLyB0aGlzIHJldmVyc2VzIHRoZSBuZXN0aW5nIHNvIGxvd2VzdCBsZXZlbCBlcnJvciBpcyB0aGUgdG9wIGxldmVsIGVycm9yIGluIG91ciB0ZWxlbWV0cnlcbiAgICAgICAgZXJyb3JEZXRhaWwuY2F1c2VkID0gZXJyb3JEZXRhaWxzO1xuICAgICAgfVxuXG4gICAgICBlcnJvckRldGFpbHMgPSBlcnJvckRldGFpbDtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICBjdXJyZW50RXJyb3IgPSAoY3VycmVudEVycm9yIGFzIGFueSkuY2F1c2U7XG4gICAgfVxuICB9IGNhdGNoIHtcbiAgICAvLyBEb24ndCBwcm9wb2dhdGUgZXJyb3JzIHJlbGF0ZWQgdG8gbm90IGJlaW5nIGFibGUgdG8gdHJhbnNsYXRlIHRvIGVycm9yIGRhdGEsIHJldHVybiB3aGF0IHdhcyBjb2xsZWN0ZWRcbiAgICByZXR1cm4gZXJyb3JEZXRhaWxzO1xuICB9XG5cbiAgcmV0dXJuIGVycm9yRGV0YWlscztcbn07XG4iXX0=