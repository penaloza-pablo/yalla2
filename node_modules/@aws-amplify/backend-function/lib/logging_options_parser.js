import { LoggingFormat } from 'aws-cdk-lib/aws-lambda';
import { LogLevelConverter, LogRetentionConverter, } from '@aws-amplify/platform-core/cdk';
import { LogGroup } from 'aws-cdk-lib/aws-logs';
import { RemovalPolicy } from 'aws-cdk-lib';
/**
 * Creates a LogGroup with the specified retention settings
 * This replaces the deprecated logRetention property on NodejsFunction
 */
export const createLogGroup = (scope, id, loggingOptions) => {
    const retentionDays = new LogRetentionConverter().toCDKRetentionDays(loggingOptions.retention);
    return new LogGroup(scope, `${id}-log-group`, {
        retention: retentionDays,
        removalPolicy: RemovalPolicy.DESTROY, // This matches Lambda's default for auto-created log groups
    });
};
/**
 * Converts logging options to CDK format using non-deprecated properties
 */
export const convertLoggingOptionsToCDK = (loggingOptions) => {
    let level = undefined;
    if ('level' in loggingOptions) {
        level = new LogLevelConverter().toCDKLambdaApplicationLogLevel(loggingOptions.level);
    }
    const format = convertFormat(loggingOptions.format);
    return {
        level,
        format,
    };
};
/**
 * Converts format string to LoggingFormat enum
 */
const convertFormat = (format) => {
    switch (format) {
        case undefined:
            return undefined;
        case 'json':
            return LoggingFormat.JSON;
        case 'text':
            return LoggingFormat.TEXT;
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nZ2luZ19vcHRpb25zX3BhcnNlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9sb2dnaW5nX29wdGlvbnNfcGFyc2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBdUIsYUFBYSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDNUUsT0FBTyxFQUNMLGlCQUFpQixFQUNqQixxQkFBcUIsR0FDdEIsTUFBTSxnQ0FBZ0MsQ0FBQztBQUN4QyxPQUFPLEVBQWEsUUFBUSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFFM0QsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQWM1Qzs7O0dBR0c7QUFDSCxNQUFNLENBQUMsTUFBTSxjQUFjLEdBQUcsQ0FDNUIsS0FBZ0IsRUFDaEIsRUFBVSxFQUNWLGNBQXNDLEVBQzNCLEVBQUU7SUFDYixNQUFNLGFBQWEsR0FBRyxJQUFJLHFCQUFxQixFQUFFLENBQUMsa0JBQWtCLENBQ2xFLGNBQWMsQ0FBQyxTQUFTLENBQ3pCLENBQUM7SUFFRixPQUFPLElBQUksUUFBUSxDQUFDLEtBQUssRUFBRSxHQUFHLEVBQUUsWUFBWSxFQUFFO1FBQzVDLFNBQVMsRUFBRSxhQUFhO1FBQ3hCLGFBQWEsRUFBRSxhQUFhLENBQUMsT0FBTyxFQUFFLDREQUE0RDtLQUNuRyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUM7QUFFRjs7R0FFRztBQUNILE1BQU0sQ0FBQyxNQUFNLDBCQUEwQixHQUFHLENBQ3hDLGNBQXNDLEVBQ25CLEVBQUU7SUFDckIsSUFBSSxLQUFLLEdBQW9DLFNBQVMsQ0FBQztJQUN2RCxJQUFJLE9BQU8sSUFBSSxjQUFjLEVBQUUsQ0FBQztRQUM5QixLQUFLLEdBQUcsSUFBSSxpQkFBaUIsRUFBRSxDQUFDLDhCQUE4QixDQUM1RCxjQUFjLENBQUMsS0FBSyxDQUNyQixDQUFDO0lBQ0osQ0FBQztJQUVELE1BQU0sTUFBTSxHQUFHLGFBQWEsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUM7SUFFcEQsT0FBTztRQUNMLEtBQUs7UUFDTCxNQUFNO0tBQ1AsQ0FBQztBQUNKLENBQUMsQ0FBQztBQUVGOztHQUVHO0FBQ0gsTUFBTSxhQUFhLEdBQUcsQ0FBQyxNQUFtQyxFQUFFLEVBQUU7SUFDNUQsUUFBUSxNQUFNLEVBQUUsQ0FBQztRQUNmLEtBQUssU0FBUztZQUNaLE9BQU8sU0FBUyxDQUFDO1FBQ25CLEtBQUssTUFBTTtZQUNULE9BQU8sYUFBYSxDQUFDLElBQUksQ0FBQztRQUM1QixLQUFLLE1BQU07WUFDVCxPQUFPLGFBQWEsQ0FBQyxJQUFJLENBQUM7SUFDOUIsQ0FBQztBQUNILENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEZ1bmN0aW9uTG9nZ2luZ09wdGlvbnMgfSBmcm9tICcuL2ZhY3RvcnkuanMnO1xuaW1wb3J0IHsgQXBwbGljYXRpb25Mb2dMZXZlbCwgTG9nZ2luZ0Zvcm1hdCB9IGZyb20gJ2F3cy1jZGstbGliL2F3cy1sYW1iZGEnO1xuaW1wb3J0IHtcbiAgTG9nTGV2ZWxDb252ZXJ0ZXIsXG4gIExvZ1JldGVudGlvbkNvbnZlcnRlcixcbn0gZnJvbSAnQGF3cy1hbXBsaWZ5L3BsYXRmb3JtLWNvcmUvY2RrJztcbmltcG9ydCB7IElMb2dHcm91cCwgTG9nR3JvdXAgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtbG9ncyc7XG5pbXBvcnQgeyBDb25zdHJ1Y3QgfSBmcm9tICdjb25zdHJ1Y3RzJztcbmltcG9ydCB7IFJlbW92YWxQb2xpY3kgfSBmcm9tICdhd3MtY2RrLWxpYic7XG5cbi8qKlxuICogQ0RLIExhbWJkYSBsb2dnaW5nIG9wdGlvbnMgdXNpbmcgbm9uLWRlcHJlY2F0ZWQgcHJvcGVydGllc1xuICogLSBsZXZlbDogQXBwbGljYXRpb25Mb2dMZXZlbCBmb3IgdGhlIGxhbWJkYSBmdW5jdGlvbiAobWFwcyB0byBhcHBsaWNhdGlvbkxvZ0xldmVsVjIpXG4gKiAtIGZvcm1hdDogTG9nZ2luZyBmb3JtYXQgKEpTT04gb3IgVEVYVClcbiAqIC0gbG9nR3JvdXA6IEN1c3RvbSBsb2cgZ3JvdXAgZm9yIHRoZSBmdW5jdGlvbiAocHJlZmVycmVkIG92ZXIgdXNpbmcgbG9nUmV0ZW50aW9uIGRpcmVjdGx5KVxuICovXG5leHBvcnQgdHlwZSBDREtMb2dnaW5nT3B0aW9ucyA9IHtcbiAgbGV2ZWw/OiBBcHBsaWNhdGlvbkxvZ0xldmVsO1xuICBmb3JtYXQ/OiBMb2dnaW5nRm9ybWF0O1xuICBsb2dHcm91cD86IElMb2dHcm91cDtcbn07XG5cbi8qKlxuICogQ3JlYXRlcyBhIExvZ0dyb3VwIHdpdGggdGhlIHNwZWNpZmllZCByZXRlbnRpb24gc2V0dGluZ3NcbiAqIFRoaXMgcmVwbGFjZXMgdGhlIGRlcHJlY2F0ZWQgbG9nUmV0ZW50aW9uIHByb3BlcnR5IG9uIE5vZGVqc0Z1bmN0aW9uXG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVMb2dHcm91cCA9IChcbiAgc2NvcGU6IENvbnN0cnVjdCxcbiAgaWQ6IHN0cmluZyxcbiAgbG9nZ2luZ09wdGlvbnM6IEZ1bmN0aW9uTG9nZ2luZ09wdGlvbnMsXG4pOiBJTG9nR3JvdXAgPT4ge1xuICBjb25zdCByZXRlbnRpb25EYXlzID0gbmV3IExvZ1JldGVudGlvbkNvbnZlcnRlcigpLnRvQ0RLUmV0ZW50aW9uRGF5cyhcbiAgICBsb2dnaW5nT3B0aW9ucy5yZXRlbnRpb24sXG4gICk7XG5cbiAgcmV0dXJuIG5ldyBMb2dHcm91cChzY29wZSwgYCR7aWR9LWxvZy1ncm91cGAsIHtcbiAgICByZXRlbnRpb246IHJldGVudGlvbkRheXMsXG4gICAgcmVtb3ZhbFBvbGljeTogUmVtb3ZhbFBvbGljeS5ERVNUUk9ZLCAvLyBUaGlzIG1hdGNoZXMgTGFtYmRhJ3MgZGVmYXVsdCBmb3IgYXV0by1jcmVhdGVkIGxvZyBncm91cHNcbiAgfSk7XG59O1xuXG4vKipcbiAqIENvbnZlcnRzIGxvZ2dpbmcgb3B0aW9ucyB0byBDREsgZm9ybWF0IHVzaW5nIG5vbi1kZXByZWNhdGVkIHByb3BlcnRpZXNcbiAqL1xuZXhwb3J0IGNvbnN0IGNvbnZlcnRMb2dnaW5nT3B0aW9uc1RvQ0RLID0gKFxuICBsb2dnaW5nT3B0aW9uczogRnVuY3Rpb25Mb2dnaW5nT3B0aW9ucyxcbik6IENES0xvZ2dpbmdPcHRpb25zID0+IHtcbiAgbGV0IGxldmVsOiBBcHBsaWNhdGlvbkxvZ0xldmVsIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuICBpZiAoJ2xldmVsJyBpbiBsb2dnaW5nT3B0aW9ucykge1xuICAgIGxldmVsID0gbmV3IExvZ0xldmVsQ29udmVydGVyKCkudG9DREtMYW1iZGFBcHBsaWNhdGlvbkxvZ0xldmVsKFxuICAgICAgbG9nZ2luZ09wdGlvbnMubGV2ZWwsXG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0IGZvcm1hdCA9IGNvbnZlcnRGb3JtYXQobG9nZ2luZ09wdGlvbnMuZm9ybWF0KTtcblxuICByZXR1cm4ge1xuICAgIGxldmVsLFxuICAgIGZvcm1hdCxcbiAgfTtcbn07XG5cbi8qKlxuICogQ29udmVydHMgZm9ybWF0IHN0cmluZyB0byBMb2dnaW5nRm9ybWF0IGVudW1cbiAqL1xuY29uc3QgY29udmVydEZvcm1hdCA9IChmb3JtYXQ6ICdqc29uJyB8ICd0ZXh0JyB8IHVuZGVmaW5lZCkgPT4ge1xuICBzd2l0Y2ggKGZvcm1hdCkge1xuICAgIGNhc2UgdW5kZWZpbmVkOlxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICBjYXNlICdqc29uJzpcbiAgICAgIHJldHVybiBMb2dnaW5nRm9ybWF0LkpTT047XG4gICAgY2FzZSAndGV4dCc6XG4gICAgICByZXR1cm4gTG9nZ2luZ0Zvcm1hdC5URVhUO1xuICB9XG59O1xuIl19